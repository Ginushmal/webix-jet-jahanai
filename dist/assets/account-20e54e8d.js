import{z as r}from"./index-da487600.js";import"./photo-85d3a37a.js";function l(){return c}const c=[{id:"$empty",value:"-- Not selected --",$empty:!0},{id:"1",value:"Tirane, Albania"},{id:"2",value:"Buenos Aires, Argentina"},{id:"3",value:"Canberra, Australia"},{id:"4",value:"Vienna, Austria"},{id:"5",value:"Minsk, Belarus"},{id:"6",value:"Brussels, Belgium"},{id:"7",value:"Brasilia, Brazil"},{id:"8",value:"Ottawa, Canada"},{id:"9",value:"Beijing, China"},{id:"10",value:"Prague, Czech Republic"},{id:"11",value:"Copenhagen, Denmark"},{id:"12",value:"Cairo, Egypt"},{id:"13",value:"Helsinki, Finland"},{id:"14",value:"Paris, France"},{id:"15",value:"Tbilisi, Georgia"},{id:"16",value:"Berlin, Germany"},{id:"17",value:"New Delhi, India"},{id:"18",value:"Dublin, Ireland"},{id:"19",value:"Rome, Italy"},{id:"20",value:"Tokyo, Japan"},{id:"21",value:"Wellington, New Zealand"},{id:"22",value:"Seoul, Republic of Korea"},{id:"23",value:"Madrid, Spain"},{id:"24",value:"Stockholm, Sweden"},{id:"25",value:"Washington, United States"}];function d(){return u}const u=[{id:"$empty",value:"-- Not selected --",$empty:!0},{id:"1",value:"Chief Scientific Officer",color:"#8664C6"},{id:"2",value:"Chief Technology Officer",color:"#1CA1C1"},{id:"3",value:"Chief Executive Officer",color:"#F8643F"}],n={apiServer:"http://127.0.0.1:8000/",getAccountSettings:function(){return webix.ajax().get(this.apiServer+"/api/account/").then(t=>t.json()).catch(t=>{throw webix.message({type:"error",text:"Failed to load account settings"}),t})},updateAccountSettings:function(t){return webix.ajax().put(this.apiServer+"/api/account/",t).then(e=>e.json()).catch(e=>{throw webix.message({type:"error",text:"Failed to update account settings"}),e})},getNotificationSettings:function(){return webix.ajax().get(this.apiServer+"/api/notifications/").then(t=>t.json()).catch(t=>{throw webix.message({type:"error",text:"Failed to load notification settings"}),t})},updateNotificationSettings:function(t){return webix.ajax().put(this.apiServer+"/api/notifications/",t).then(e=>e.json()).catch(e=>{throw webix.message({type:"error",text:"Failed to update notification settings"}),e})},getThemeSettings:function(){return webix.ajax().get(this.apiServer+"/api/theme/").then(t=>t.json()).catch(t=>{throw webix.message({type:"error",text:"Failed to load theme settings"}),t})},updateThemeSettings:function(t){return webix.ajax().put(this.apiServer+"/api/theme/",t).then(e=>e.json()).catch(e=>{throw webix.message({type:"error",text:"Failed to update theme settings"}),e})},getPrivacySettings:function(){return webix.ajax().get(this.apiServer+"/api/privacy/").then(t=>t.json()).catch(t=>{throw webix.message({type:"error",text:"Failed to load privacy settings"}),t})},updatePrivacySettings:function(t){return webix.ajax().put(this.apiServer+"/api/privacy/",t).then(e=>e.json()).catch(e=>{throw webix.message({type:"error",text:"Failed to update privacy settings"}),e})}};class g extends r{config(){const e=webix.Date.dateToStr("%d %M %Y"),s={margin:48,cols:[{margin:10,rows:[{view:"text",name:"first_name",label:"First name",labelPosition:"top",placeholder:"First name",invalidMessage:"A name is required",tooltip:"Client's name is #value#"},{view:"text",name:"last_name",label:"Last name",labelPosition:"top",placeholder:"Last name",tooltip:"Client's last name is #value#"},{view:"richselect",name:"position",localId:"position:combo",label:"Position",labelPosition:"top",placeholder:"Click to select",options:d(),tooltip:i=>i.value?"The position that client occupies within their company":"<span class='notselected'>Not selected</span>"},{view:"text",name:"email",label:"Email",labelPosition:"top",placeholder:"Email",tooltip:i=>i.value?"The working email address of the client":"<span class='notselected'>Not specified</span>"},{view:"richselect",name:"city",localId:"cities:combo",label:"City, country",labelPosition:"top",placeholder:"Click to select",options:l(),tooltip:i=>i.value?"The city where the client works":"<span class='notselected'>Not selected</span>"}]},{margin:10,rows:[{view:"text",name:"address",label:"Address",labelPosition:"top",placeholder:"Address",tooltip:i=>i.value?"The address of the client's office":"<span class='notselected'>Not specified</span>"},{view:"datepicker",name:"birthday",label:"Birthday",labelPosition:"top",placeholder:"Click to select",format:e,tooltip:i=>{let a="Client is ";if(i.value){a+=Math.floor((new Date-i.value)/(1e3*60*60*24*365))+" years old";let o=new Date;o.setMonth(i.value.getMonth()),o.setDate(i.value.getDate()),o<new Date&&webix.Date.add(o,1,"year"),a+="<br>Next birthday is on "+e(o)}return a}},{view:"text",name:"phone",label:"Phone",labelPosition:"top",placeholder:"Phone"}]}]};return{rows:[{template:"Profile information",type:"header"},{view:"form",localId:"form",padding:24,rows:[s,{},{margin:10,cols:[{},{view:"button",value:"Reset",autowidth:!0,click:()=>{this.$$("form").clear()},tooltip:"Click to clean the form"},{view:"button",value:"Save",type:"form",autowidth:!0,tooltip:"Save changes",click:()=>{if(console.log(this.$$("form").validate()),this.$$("form").validate()){const i=this.$$("form").getValues();console.log("Form data:",i),i.birthday&&(i.birthday=webix.Date.dateToStr("%Y-%m-%d")(i.birthday)),n.updateAccountSettings(i).then(a=>{webix.message("Saved","success")}).catch(a=>{webix.message({type:"error",text:"Failed to save preferences"}),console.error("Error updating preferences:",a)})}}}]}],rules:{first_name:webix.rules.isNotEmpty,email:webix.rules.isEmail,phone:i=>!i||/^\+?\d{10,15}$/.test(i)}}]}}init(){n.getAccountSettings().then(e=>{this.$$("form").setValues({first_name:e.first_name||"",last_name:e.last_name||"",email:e.email||"",city:e.city||"",position:e.position||"",address:e.address||"",birthday:e.birthday?new Date(e.birthday):"",phone:e.phone||""})}).catch(e=>{console.error("Error loading preferences:",e)})}}export{g as default};
